pipeline{
            agent any
            
            parameters {
         choice(name: 'action', choices: ['plan', 'apply','destroy'], description: 'terraform action')
		 
      
                       }
            stages{
                           stage ('terraform init') {
                                    steps{
                                        bat "terraform init"     
                                    }
                                    
                        }   
			  stage ('terraform plan') {
			   when {
                 expression { params.action == 'plan' }
        			}
                                    steps{
                                        bat "terraform plan"     
             					} 
         				   }
					   
				  stage ('terraform apply') {
			   when {
                 expression { params.action == 'apply' }
        			}
				 
                                    steps{
                                        bat "terraform apply -auto-approve"     
             					} 
         				   }
					   
					     stage ('terraform destroy') {
			   when {
                 expression { params.action == 'destroy' }
        			}
                                    steps{
                                        bat "terraform destroy -auto-approve"     
             					} 
         				   }
					   
			   }
}
